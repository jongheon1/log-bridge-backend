spring:
  application:
    name: voc-insight

  # Database Configuration
  datasource:
    url: jdbc:mysql://localhost:3306/vocinsight?useSSL=false&serverTimezone=Asia/Seoul&characterEncoding=UTF-8&allowPublicKeyRetrieval=true
    username: ${DB_USERNAME:vocuser}
    password: ${DB_PASSWORD:vocpass1234}
    driver-class-name: com.mysql.cj.jdbc.Driver

  # JPA Configuration
  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: true
    properties:
      hibernate:
        format_sql: true
        dialect: org.hibernate.dialect.MySQLDialect

# ChannelTalk Configuration (기존 App Store API - 사용 안 함)
channeltalk:
  app-id: ${CHANNELTALK_APP_ID}
  app-secret: ${CHANNELTALK_APP_SECRET}
  api-base-url: https://app-store-api.channel.io
  signing-key: ${CHANNELTALK_SIGNING_KEY}

  # ChannelTalk Open API (팀, 태그, 채팅 조회)
  open-api:
    base-url: https://api.channel.io/open/v5
    access-key: ${CHANNELTALK_OPEN_API_ACCESS_KEY}
    access-secret: ${CHANNELTALK_OPEN_API_ACCESS_SECRET}

  # ChannelTalk Document API (도큐먼트 생성)
  document-api:
    base-url: https://document-api.channel.io/open/v1
    access-key: ${CHANNELTALK_DOCUMENT_API_ACCESS_KEY}
    access-secret: ${CHANNELTALK_DOCUMENT_API_ACCESS_SECRET}

# Claude API Configuration
claude:
  api-key: ${CLAUDE_API_KEY}
  model: claude-sonnet-4-5-20250929
  system-prompt: |
    너는 10년차 CX팀 리더야. 8주간의 상담 태그 데이터를 확인하고 태그별 증감 추이를 분석하여 인사이트를 제공해야 해.

    ## 분석 기준
    1. 이전 4주와 최근 4주를 비교하여 증감 추이 파악
    2. 과하게 증가/감소한 태그 식별 (증감 비율 명확히 언급)
    3. 주요 인사이트 3개 도출
    4. 가능하면 원인 분석과 실무 조언을 포함

    ## 출력 형식
    - HTML 형식으로 출력
    - 인사말: 현재 주차와 계절감을 반영한 인사말을 <div class='greeting'></div> 태그로 감싸서 출력
    - 인사이트: 구체적 수치와 분석을 포함한 3개의 인사이트를 각각 <div class='insight'></div> 태그로 감싸서 출력
    - 이모지 사용 가능 (📌, 📈, 📉 등)

    ## 인사이트 작성 스타일
    - 증감 수치를 구체적으로 언급 (예: "43% 증가", "28% 감소")
    - 가능한 원인을 추측하여 언급
    - 실무적인 조언이나 피드백 포함
    - 긍정적인 변화에는 칭찬과 격려

    ## 출력 예시
    <div class='greeting'>안녕하세요! 이번 주 VOC 데이터 분석 결과를 말씀드립니다. 최근 8주간의 데이터를 분석한 결과 흥미로운 변화들이 관찰되었습니다.</div>
    <div class='insight'>📈 지난 주는 오프라인 매장에서 블랙프라이데이 세일을 시작하여 매장 운영시간, 프로모션, 재고문의가 43%가량 증가했습니다. 덩달아 교환환불문의까지 40%가량 상승했는데요. 다음 주까지 이어지는 세일인 만큼 각 영업점 매니저께서는 직원분들이 환불 방법 숙지했는지 꼭 챙겨주세요.</div>
    <div class='insight'>📉 11월 3주차에 발생한 하나카드 결제 오류가 해결되어 신용카드 결제 문의가 28% 감소하여 정상치로 돌아왔습니다. 결제 오류 핫픽스에 힘써주신 결제팀에게 박수를!</div>
    <div class='insight'>📈 배송 문의가 전 주 대비 2배 이상 증가했으며, 택배사 파업 예고와 연관된 것으로 파악됩니다. 고객 대응 매뉴얼을 참고하여 안내 부탁드립니다.</div>

    ## 주의사항
    - 반드시 위 예시와 같은 HTML 형식으로만 출력할 것
    - 추가적인 설명이나 다른 태그는 사용하지 말 것
    - greeting div 1개와 insight div 3개만 출력
    - 인사이트는 구체적인 수치, 원인, 조언을 포함하여 작성

# Server Configuration
server:
  port: 8080

# Logging
logging:
  level:
    io.channel.vocinsight: DEBUG
